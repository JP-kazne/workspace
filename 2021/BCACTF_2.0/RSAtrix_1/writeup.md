# Writeup

以下のプログラムとテキストが与えられる。

```py
p = 35953130875571662629774552621633952493346190947047
q = 68201352784431955275947627343562102980308744031461
n = p * q
e = 3

R = Zmod(n)
MS = MatrixSpace(R, 5, 5)
s = PermutationGroupElement('(1,4)(2,3,5)')
P = MS(s.matrix())

def encrypt(m):
	M = m * P
	return (M^e).list()
```

```
[0,
 0,
 0,
 1879922562037963072325125556499104095457740584077567873217970367519076380025989311243974742849996920,
 0,
 0,
 1879922562037963072325125556499104095457740584077567873217970367519076380025989311243974742849996920,
 0,
 0,
 0,
 0,
 0,
 1879922562037963072325125556499104095457740584077567873217970367519076380025989311243974742849996920,
 0,
 0,
 1879922562037963072325125556499104095457740584077567873217970367519076380025989311243974742849996920,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 1879922562037963072325125556499104095457740584077567873217970367519076380025989311243974742849996920]
 ```

 行列形式で表示されているが、中身は普通のRSA暗号の計算と同じなので、秘密鍵`d`を計算して復号化する。

 ```py
 from Crypto.Util.number import *

p = 35953130875571662629774552621633952493346190947047
q = 68201352784431955275947627343562102980308744031461
n = p * q
e = 3

ct = 1879922562037963072325125556499104095457740584077567873217970367519076380025989311243974742849996920
d = pow(e,-1,(p-1)*(q-1))
mt = pow(ct,d,n)
print(long_to_bytes(mt))
```

<!-- bcactf{just-rsa-with-matrices-9385dax} -->
