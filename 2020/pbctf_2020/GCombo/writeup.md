# Writeup

問題のリンク先に飛ぶと、Googleフォームの画面になる。0~9の選択肢があり、選択すれば次に進むことができる。

ページのソースを読むと`<script>`タグに以下のような記述がある。

<details><summary>script</summary>

```js
var FB_PUBLIC_LOAD_DATA_ = [null,[null,[[938169490,null,null,2,[[1420416147,[["1",null,1935811336,null,0]
,["2",null,1935811336,null,0]
,["3",null,1935811336,null,0]
,["4",null,1935811336,null,0]
,["5",null,1114266997,null,0]
,["6",null,1935811336,null,0]
,["7",null,1935811336,null,0]
,["8",null,1935811336,null,0]
,["9",null,1935811336,null,0]
,["0",null,1935811336,null,0]
]
,1,null,null,null,null,null,0]
]
]
,[691517430,null,null,8]
,[566314179,null,null,2,[[1728367628,[["1",null,1076236325,null,0]
,["2",null,1076236325,null,0]
,["3",null,1076236325,null,0]
,["4",null,1076236325,null,0]
,["5",null,1076236325,null,0]
,["6",null,1076236325,null,0]
,["7",null,1076236325,null,0]
,["8",null,1076236325,null,0]
,["9",null,311281996,null,0]
,["0",null,1076236325,null,0]
]
,1,null,null,null,null,null,0]
]
]
,[1996292448,null,null,8]
,[255198225,null,null,2,[[810673342,[["1",null,918802994,null,0]
,["2",null,311281996,null,0]
,["3",null,78472441,null,0]
,["4",null,691517430,null,0]
,["5",null,29278772,null,0]
,["6",null,691517430,null,0]
,["7",null,918802994,null,0]
,["8",null,691517430,null,0]
,["9",null,1138684813,null,0]
,["0",null,29278772,null,0]
]
,1,null,null,null,null,null,0]
]
]
,[147720654,null,null,8]
,[1968136211,null,null,2,[[715448114,[["1",null,311281996,null,0]
,["2",null,1737460359,null,0]
,["3",null,1076236325,null,0]
,["4",null,1935811336,null,0]
,["5",null,1935811336,null,0]
,["6",null,694883742,null,0]
,["7",null,78472441,null,0]
,["8",null,911811804,null,0]
,["9",null,691517430,null,0]
,["0",null,29278772,null,0]
]
,1,null,null,null,null,null,0]
]
]
,[918802994,null,null,8]
,[1421773386,null,null,2,[[1855524489,[["1",null,29278772,null,0]
,["2",null,29278772,null,0]
,["3",null,29278772,null,0]
,["4",null,1935811336,null,0]
,["5",null,29278772,null,0]
,["6",null,29278772,null,0]
,["7",null,918802994,null,0]
,["8",null,29278772,null,0]
,["9",null,29278772,null,0]
,["0",null,29278772,null,0]
]
,1,null,null,null,null,null,0]
]
]
,[1094087816,null,null,8]
,[479285638,null,null,2,[[543826744,[["1",null,147720654,null,0]
,["2",null,267261990,null,0]
,["3",null,29278772,null,0]
,["4",null,311281996,null,0]
,["5",null,29278772,null,0]
,["6",null,29278772,null,0]
,["7",null,29278772,null,0]
,["8",null,911811804,null,0]
,["9",null,29278772,null,0]
,["0",null,694883742,null,0]
]
,1,null,null,null,null,null,0]
]
]
,[267261990,null,null,8]
,[968358138,null,null,2,[[1434188549,[["1",null,78472441,null,0]
,["2",null,78472441,null,0]
,["3",null,78472441,null,0]
,["4",null,78472441,null,0]
,["5",null,78472441,null,0]
,["6",null,78472441,null,0]
,["7",null,78472441,null,0]
,["8",null,78472441,null,0]
,["9",null,78472441,null,0]
,["0",null,1935811336,null,0]
]
,1,null,null,null,null,null,0]
]
]
,[311281996,null,null,8]
,[134264431,null,null,2,[[1393438304,[["1",null,691517430,null,0]
,["2",null,691517430,null,0]
,["3",null,691517430,null,0]
,["4",null,691517430,null,0]
,["5",null,691517430,null,0]
,["6",null,691517430,null,0]
,["7",null,691517430,null,0]
,["8",null,29278772,null,0]
,["9",null,918802994,null,0]
,["0",null,691517430,null,0]
]
,1,null,null,null,null,null,0]
]
]
,[1138684813,null,null,8]
,[1618229729,null,null,2,[[1942029415,[["1",null,29278772,null,0]
,["2",null,29278772,null,0]
,["3",null,46599266,null,0]
,["4",null,918802994,null,0]
,["5",null,1935811336,null,0]
,["6",null,1935811336,null,0]
,["7",null,1935811336,null,0]
,["8",null,691517430,null,0]
,["9",null,267261990,null,0]
,["0",null,694883742,null,0]
]
,1,null,null,null,null,null,0]
]
]
,[29278772,null,null,8]
,[356414873,null,null,2,[[1297001036,[["1",null,311281996,null,0]
,["2",null,311281996,null,0]
,["3",null,1935811336,null,0]
,["4",null,311281996,null,0]
,["5",null,918802994,null,0]
,["6",null,311281996,null,0]
,["7",null,311281996,null,0]
,["8",null,311281996,null,0]
,["9",null,311281996,null,0]
,["0",null,311281996,null,0]
]
,1,null,null,null,null,null,0]
]
]
,[751651474,null,null,8]
,[766405565,"Password Please",null,0,[[1674649702,null,1,null,[[4,301,["s3cuR3_p1n_id_2_3v3ry0ne"]
,"Invalid password!"]
]
]
]
]
,[1935811336,null,null,8,null,-3]
,[1068483333,null,null,2,[[1193056009,[["1",null,918802994,null,0]
,["2",null,918802994,null,0]
,["3",null,918802994,null,0]
,["4",null,918802994,null,0]
,["5",null,1935811336,null,0]
,["6",null,918802994,null,0]
,["7",null,918802994,null,0]
,["8",null,918802994,null,0]
,["9",null,918802994,null,0]
,["0",null,918802994,null,0]
]
,1,null,null,null,null,null,0]
]
]
,[1114266997,null,null,8]
,[1155155958,null,null,2,[[203483032,[["1",null,918802994,null,0]
,["2",null,918802994,null,0]
,["3",null,918802994,null,0]
,["4",null,918802994,null,0]
,["5",null,918802994,null,0]
,["6",null,918802994,null,0]
,["7",null,918802994,null,0]
,["8",null,1094087816,null,0]
,["9",null,918802994,null,0]
,["0",null,918802994,null,0]
]
,1,null,null,null,null,null,0]
]
]
,[1566374398,null,null,8]
,[1166405465,null,null,2,[[808283334,[["1",null,78472441,null,0]
,["2",null,78472441,null,0]
,["3",null,78472441,null,0]
,["4",null,78472441,null,0]
,["5",null,29278772,null,0]
,["6",null,29278772,null,0]
,["7",null,1385363611,null,0]
,["8",null,691517430,null,0]
,["9",null,311281996,null,0]
,["0",null,311281996,null,0]
]
,1,null,null,null,null,null,0]
]
]
,[1737460359,null,null,8]
,[1840461575,null,null,2,[[1332022630,[["1",null,918802994,null,0]
,["2",null,918802994,null,0]
,["3",null,29278772,null,0]
,["4",null,1935811336,null,0]
,["5",null,29278772,null,0]
,["6",null,1996292448,null,0]
,["7",null,694883742,null,0]
,["8",null,694883742,null,0]
,["9",null,267261990,null,0]
,["0",null,1076236325,null,0]
]
,1,null,null,null,null,null,0]
]
]
,[1076236325,null,null,8]
,[797867693,null,null,2,[[377985608,[["1",null,267261990,null,0]
,["2",null,267261990,null,0]
,["3",null,311281996,null,0]
,["4",null,267261990,null,0]
,["5",null,267261990,null,0]
,["6",null,267261990,null,0]
,["7",null,267261990,null,0]
,["8",null,267261990,null,0]
,["9",null,267261990,null,0]
,["0",null,267261990,null,0]
]
,1,null,null,null,null,null,0]
]
]
,[911811804,null,null,8]
,[519821694,null,null,2,[[375069514,[["1",null,691517430,null,0]
,["2",null,694883742,null,0]
,["3",null,694883742,null,0]
,["4",null,694883742,null,0]
,["5",null,694883742,null,0]
,["6",null,267261990,null,0]
,["7",null,694883742,null,0]
,["8",null,694883742,null,0]
,["9",null,694883742,null,0]
,["0",null,694883742,null,0]
]
,1,null,null,null,null,null,0]
]
]
,[46599266,null,null,8]
,[1390310175,null,null,2,[[1697347835,[["1",null,1935811336,null,0]
,["2",null,1935811336,null,0]
,["3",null,1566374398,null,0]
,["4",null,1935811336,null,0]
,["5",null,267261990,null,0]
,["6",null,1076236325,null,0]
,["7",null,918802994,null,0]
,["8",null,691517430,null,0]
,["9",null,694883742,null,0]
,["0",null,78472441,null,0]
]
,1,null,null,null,null,null,0]
]
]
,[694883742,null,null,8]
,[522640729,null,null,2,[[1902611163,[["1",null,1935811336,null,0]
,["2",null,918802994,null,0]
,["3",null,1935811336,null,0]
,["4",null,1935811336,null,0]
,["5",null,29278772,null,0]
,["6",null,311281996,null,0]
,["7",null,1935811336,null,0]
,["8",null,1935811336,null,0]
,["9",null,1935811336,null,0]
,["0",null,1935811336,null,0]
]
,1,null,null,null,null,null,0]
]
]
,[1385363611,null,null,8,null,-2]
,[1048798699,null,null,2,[[40272340,[["1",null,918802994,null,0]
,["2",null,311281996,null,0]
,["3",null,694883742,null,0]
,["4",null,691517430,null,0]
,["5",null,911811804,null,0]
,["6",null,691517430,null,0]
,["7",null,918802994,null,0]
,["8",null,691517430,null,0]
,["9",null,1935811336,null,0]
,["0",null,751651474,null,0]
]
,1,null,null,null,null,null,0]
]
]
,[78472441,null,null,8]
,[1849390960,null,null,2,[[200591249,[["1",null,911811804,null,0]
,["2",null,911811804,null,0]
,["3",null,311281996,null,0]
,["4",null,911811804,null,0]
,["5",null,911811804,null,0]
,["6",null,911811804,null,0]
,["7",null,911811804,null,0]
,["8",null,911811804,null,0]
,["9",null,911811804,null,0]
,["0",null,911811804,null,0]
]
,1,null,null,null,null,null,0]
]
]
]
,["Congratulations! The flag is pbctf{\u003cdigits you got along the way\u003e_\u003cpassword\u003e}",1,0,0,0]
,null,null,[0,0]
,null,null,"Enter combination code",48,[null,null,null,null,0]
,null,null,null,null,[2]
,[[1,1,1,1,1]
,1]
]
,"/forms","Combolock PROD",null,null,null,"",null,0,0,null,"",0,"e/1FAIpQLSe7sOTLHmGjmUY3iE6E7QLqeYAZDfQXsiJrz8r-ZcA_4cXNFQ",0,"[]",0,0]
;
```
</details>

<br>

0~9の選択肢があるので、どうやら`FB_PUBLIC_LOAD_DATA_`という変数はフォームの状態遷移を示しているようだ。

この情報をもとに状態遷移を答えから逆算する。

初期状態：State938169490

終了状態：State751651474

```mermaid
stateDiagram
    [*] --> State938169490
    State938169490 --> State1114266997:5
    State1114266997 --> State1094087816:8
    State1094087816 --> State147720654:1
    State147720654 --> State1737460359:2
    State1737460359 --> State1996292448:6
    State1996292448 --> State1138684813:9
    State1138684813 --> State46599266:3
    State46599266 --> State1566374398:3
    State1566374398 --> State1385363611:7
    State1385363611 --> State751651474:0
    State751651474 --> [*]
```

結果的に、`5812693370` と進むと以下のフォームが表示される状態にたどり着く。

![](img/2020-12-05-15-13-40.png)

`Congratulations! The flag is pbctf{<digits you got along the way>_<password>}`

パスワードはソースに書いてある通り`s3cuR3_p1n_id_2_3v3ry0ne`なので、先ほどの数字と組み合わせればフラグが得られる。

<!-- pbctf{5812693370_s3cuR3_p1n_id_2_3v3ry0ne} -->


